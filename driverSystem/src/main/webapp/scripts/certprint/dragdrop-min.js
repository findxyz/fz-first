Number.prototype.NaN0=function(){return isNaN(this)?0:this};var iMouseDown=!1,dragObject=null,curTarget=null,dropObject=null,dataDetail=null;function makeDraggable(a){if(a)a.onmousedown=function(a){dragObject=this;mouseOffset=getMouseOffset(this,a);return!1}}function getMouseOffset(a,b){b=b||window.event;var c=getPosition(a),d=mouseCoords(b);return{x:d.x-c.x,y:d.y-c.y}}
function getPosition(a){for(var b=0,c=0;a.offsetParent;)b+=a.offsetLeft+(a.currentStyle?parseInt(a.currentStyle.borderLeftWidth).NaN0():0),c+=a.offsetTop+(a.currentStyle?parseInt(a.currentStyle.borderTopWidth).NaN0():0),a=a.offsetParent;b+=a.offsetLeft+(a.currentStyle?parseInt(a.currentStyle.borderLeftWidth).NaN0():0);c+=a.offsetTop+(a.currentStyle?parseInt(a.currentStyle.borderTopWidth).NaN0():0);return{x:b,y:c}}
function mouseCoords(a){if(a.pageX||a.pageY)return{x:a.pageX,y:a.pageY};return{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}}function mouseDown(a){a=a||window.event;a=a.target||a.srcElement;if(a.onmousedown||a.getAttribute("DragObj"))return!1}
function mouseUp(){if(dragObject){if(dataDetail=document.getElementById("dataDetail"))dataDetail.value=navigator.appName.indexOf("Explorer")>-1?dragObject.innerText:dragObject.textContent;dropObject=dragObject}dragObject=null;iMouseDown=!1}function mouseMove(a){a=a||window.event;a=mouseCoords(a);if(dragObject)dragObject.style.position="absolute",dragObject.style.top=a.y-mouseOffset.y,dragObject.style.left=a.x-mouseOffset.x;lMouseState=iMouseDown;if(curTarget||dragObject)return!1}
function dropTarget(){dropObject&&dropObject.parentNode.removeChild(dropObject)}document.onmousemove=mouseMove;document.onmousedown=mouseDown;document.onmouseup=mouseUp;
